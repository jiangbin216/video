!function(e){e.fn.tableExport=function(t){function n(){var e=[];return c.find("thead th").each(function(t,n){i.length?i.forEach(function(a){a==t+1&&e.push(n.innerText)}):e.push(n.innerText)}),e}function a(){var t=[];return c.find("tbody tr").each(function(n,a){var o=[];i.length?(i.forEach(function(t){o.push(e(a).find("td:nth-child("+t+")").text())}),t.push(o)):(e(a).find("td").each(function(e,t){o.push(t.innerText)}),t.push(o))}),t}function o(e,t,n){var a=document.createElement("a");a.href=URL.createObjectURL(new Blob([e],{type:f[n]}));for(var o=new Date,r=["DD:"+o.getDate(),"MM:"+o.getDate(),"YY:"+o.getFullYear(),"hh:"+o.getHours(),"mm:"+o.getMinutes(),"ss:"+o.getSeconds()],c=0;c<r.length;c++){var i=r[c].split(":")[0],l=r[c].split(":")[1];t=t.replace("%"+i+"%",l)}a.download=t+"."+n,a.click(),a.remove()}var r=e.extend({filename:"table",format:"csv",cols:"",head_delimiter:";",column_delimiter:";",onbefore:function(e){},onafter:function(e){}},t),t=e.extend(r,t),c=e(this),i=t.cols?t.cols.split(","):[],l="",f={csv:"text/csv,charset=UTF-8",txt:"text/plain,charset=UTF-8",xls:"application/vnd.ms-excel,charset=UTF-8",json:"application/json,charset=UTF-8"};if(!("function"==typeof t.onbefore&&"function"==typeof t.onafter&&t.format&&t.head_delimiter&&t.column_delimiter&&t.filename))return console.error("One of the parameters is incorrect."),!1;switch(t.onafter(c),t.format){case"csv":case"txt":var s=n(),h=a();l+=s.join(t.head_delimiter)+"\n",h.forEach(function(e,n){l+=e.join(t.column_delimiter)+"\n"});break;case"xls":var s=n(),h=a();template="<table><thead>%thead%</thead><tbody>%tbody%</tbody></table>";var d="";s.forEach(function(e,t){d+='<th style="border: 1px solid #c0c0c0;">'+e+"</th>"}),template=template.replace("%thead%",d),d="",h.forEach(function(e,t){d+="<tr>",e.forEach(function(e,t){d+='<td style="border: 1px solid #c0c0c0">'+e+"</td>"}),d+="</tr>"}),template=template.replace("%tbody%",d),l=template;break;case"sql":var s=n();(h=a()).forEach(function(e,t){l+="INSERT INTO table ("+s.join(",")+") VALUES ('"+e.join("','")+"');"})}o(l,t.filename,t.format),t.onbefore(c)}}(jQuery);